<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Dense Net | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Dense Net" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award." />
<meta property="og:description" content="A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award." />
<link rel="canonical" href="https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html" />
<meta property="og:url" content="https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-04T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award.","mainEntityOfPage":{"@type":"WebPage","@id":"https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html"},"@type":"BlogPosting","url":"https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html","headline":"Dense Net","dateModified":"2020-04-04T00:00:00-05:00","datePublished":"2020-04-04T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DL_from_Foundations/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cedric-perauer.github.io/DL_from_Foundations/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/DL_from_Foundations/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Dense Net | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Dense Net" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award." />
<meta property="og:description" content="A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award." />
<link rel="canonical" href="https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html" />
<meta property="og:url" content="https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-04T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award.","mainEntityOfPage":{"@type":"WebPage","@id":"https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html"},"@type":"BlogPosting","url":"https://cedric-perauer.github.io/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html","headline":"Dense Net","dateModified":"2020-04-04T00:00:00-05:00","datePublished":"2020-04-04T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://cedric-perauer.github.io/DL_from_Foundations/feed.xml" title="fastpages" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DL_from_Foundations/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DL_from_Foundations/search/">Search</a><a class="page-link" href="/DL_from_Foundations/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Dense Net</h1><p class="page-description">A summary of the Dense Net paper, the winner of the 2017 CVPR bset paper award.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-04T00:00:00-05:00" itemprop="datePublished">
        Apr 4, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/DL_from_Foundations/categories/#markdown">markdown</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#dense-net-paper-summary">Dense Net paper summary</a>
<ul>
<li class="toc-entry toc-h3"><a href="#what-did-they-try-to-accomplish-">What did they try to accomplish ?</a></li>
<li class="toc-entry toc-h3"><a href="#key-elements">Key elements</a>
<ul>
<li class="toc-entry toc-h4"><a href="#concat-and-dense-conectivity">Concat and Dense conectivity</a></li>
<li class="toc-entry toc-h4"><a href="#pooling-transition-layers">Pooling /Transition Layers</a></li>
<li class="toc-entry toc-h4"><a href="#growth-rate">Growth rate</a></li>
<li class="toc-entry toc-h4"><a href="#bottleneck-layers">Bottleneck layers</a></li>
<li class="toc-entry toc-h4"><a href="#compression">Compression</a></li>
<li class="toc-entry toc-h4"><a href="#implementation-details">Implementation Details</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#results-and-conclusion">Results and Conclusion</a></li>
<li class="toc-entry toc-h3"><a href="#references-that-are-interesting-to-follow">References that are interesting to follow</a></li>
</ul>
</li>
</ul><h2 id="dense-net-paper-summary">
<a class="anchor" href="#dense-net-paper-summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dense Net paper summary</h2>

<p><img src="https://Cedric-Perauer.github.io/DL_from_Foundations/images/densenet.png" alt="images"></p>

<h3 id="what-did-they-try-to-accomplish-">
<a class="anchor" href="#what-did-they-try-to-accomplish-" aria-hidden="true"><span class="octicon octicon-link"></span></a>What did they try to accomplish ?</h3>
<ul>
  <li>improve CNNs : fight the vanishing gradient problem, improve regularization, remove redundancy (redundant layers/neurons) existing in current CNNs (like ResNets), which in turn recudes the number of parameters</li>
</ul>

<h3 id="key-elements">
<a class="anchor" href="#key-elements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Key elements</h3>

<h4 id="concat-and-dense-conectivity">
<a class="anchor" href="#concat-and-dense-conectivity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Concat and Dense conectivity</h4>
<p>concatenating feature maps, instead of using the classic ResNet skip connection function :</p>

<p><img src="https://Cedric-Perauer.github.io/DL_from_Foundations/images/resnet_formula.png" alt="images"></p>

<p><img src="https://Cedric-Perauer.github.io/DL_from_Foundations/images/resnet_net.png" alt="images"></p>

<p>=&gt; <code class="highlighter-rouge">lth</code> layer is used as input to <code class="highlighter-rouge">(l+1)th</code> layer =&gt; <code class="highlighter-rouge">xl = Hl(xl-1)</code></p>

<ul>
  <li>Dense Nets concatenate feature maps of the same size, which means it has <code class="highlighter-rouge">L*(L+1)/(2)</code> connections instead of <code class="highlighter-rouge">L</code> in a normal network, where <code class="highlighter-rouge">L</code> is the number of layers. Consequently every Dense Net layer has access to the feature maps of the preceeding layers :</li>
</ul>

<p><img src="https://Cedric-Perauer.github.io/DL_from_Foundations/images/densenet_formula.png" alt="images"></p>

<p>The activation function Hl is a composite function with 3x3 convolutions, Batch Norm and ReLu activations.</p>

<h4 id="pooling-transition-layers">
<a class="anchor" href="#pooling-transition-layers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pooling /Transition Layers</h4>
<p>When the size of feature maps changes, concatenation is not viable. The network is divided into several Dense Blocks, in between those 2x2 average pooling with 1x1 conv filters and batch norm are applied forming a “transition layer”.</p>

<h4 id="growth-rate">
<a class="anchor" href="#growth-rate" aria-hidden="true"><span class="octicon octicon-link"></span></a>Growth rate</h4>
<p>The growth rate <code class="highlighter-rouge">k</code> is a hyperparameter which regulates how much a layer contributes to the global state. If each composite function <code class="highlighter-rouge">Hl</code> produces <code class="highlighter-rouge">k</code> feature maps, the <code class="highlighter-rouge">lth</code> layer has <code class="highlighter-rouge">k0 + k * (l-1)</code> feature-maps, where <code class="highlighter-rouge">k0</code> is the number of channels in the input layer. It has to be noted that DenseNets use narrow layers, with <code class="highlighter-rouge">k=12</code>.</p>

<h4 id="bottleneck-layers">
<a class="anchor" href="#bottleneck-layers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bottleneck layers</h4>
<p>To reduce the amount of input channels (for compute efficiency), bottleneck layers are used with <code class="highlighter-rouge">1x1 convs</code> before the <code class="highlighter-rouge">3x3 convs</code> applied.</p>

<h4 id="compression">
<a class="anchor" href="#compression" aria-hidden="true"><span class="octicon octicon-link"></span></a>Compression</h4>

<p>Compression is used to reduce the number of feature maps at transition layers, if a dense block contains <code class="highlighter-rouge">m</code> feature maps, the transition layer will generate <code class="highlighter-rouge">a*m</code> feature maps,where <code class="highlighter-rouge">0 &lt; a &lt;= 1</code> with <code class="highlighter-rouge">a = 0.5</code> in most cases.</p>

<h4 id="implementation-details">
<a class="anchor" href="#implementation-details" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implementation Details</h4>

<ul>
  <li>Kaiming/He init. is used</li>
  <li>Zero padding is used @ each Dense block</li>
  <li>Global pooling after last Dense block, with Softmax activation</li>
  <li>3 Dense blocks are used with all datasets except for ImageNet</li>
  <li>Weight decay of 10e-4</li>
  <li>Nesterov momentum of 0.9</li>
  <li>ImageNet implementation uses 7x7 convs instead of 3x3</li>
</ul>

<h3 id="results-and-conclusion">
<a class="anchor" href="#results-and-conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results and Conclusion</h3>

<p><img src="https://Cedric-Perauer.github.io/DL_from_Foundations/images/Dense_results.png" alt="images"></p>

<ul>
  <li>Bottleneck impact decreases with depth of the network</li>
  <li>not the same regularization issues as with ResNets1</li>
  <li>Dense Net BC with 15.3 Million params outperforms much larger Fractal Net (comparable to ResNet-1001), with DenseNet having 90% fewer parameters</li>
  <li>a DenseNet with as much compute complexity (FLOPS) as ResNet-50 performs on par with  ResNet-101</li>
  <li>DenseNet with 0.8 Million parameters performs as good as ResNet with 10.2 Millon parameters</li>
  <li>Deep Supervision is achieved with a single classifier. This provides easier loss functions and doesn’t need a multi classifier (like Inception).</li>
  <li>The intuition behind the good performance of DenseNets : architecture style is similar to a ResNet trained with stochastic depth, that means redundant layers are dropped from the beginning allowing smaller Networks</li>
</ul>

<h3 id="references-that-are-interesting-to-follow">
<a class="anchor" href="#references-that-are-interesting-to-follow" aria-hidden="true"><span class="octicon octicon-link"></span></a>References that are interesting to follow</h3>
<ul>
  <li><a href="https://github.com/liuzhuang13/DenseNet">DenseNets Implentation Github</a></li>
  <li><a href="https://arxiv.org/pdf/1512.03385.pdf">ResNets paper</a></li>
  <li><a href="https://arxiv.org/abs/1605.07648">Fractal Nets paper</a></li>
  <li><a href="https://arxiv.org/pdf/1502.01852.pdf">Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification</a></li>
</ul>


  </div><a class="u-url" href="/DL_from_Foundations/markdown/2020/04/04/Dense-Net.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DL_from_Foundations/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DL_from_Foundations/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Cedric-Perauer" title="Cedric-Perauer"><svg class="svg-icon grey"><use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
