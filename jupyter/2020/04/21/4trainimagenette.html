<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Fastai Course DL from the Foundations Train on Imagenette | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Fastai Course DL from the Foundations Train on Imagenette" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Imagenette and Training our classifier (Lesson 5 Part 4)" />
<meta property="og:description" content="Imagenette and Training our classifier (Lesson 5 Part 4)" />
<link rel="canonical" href="https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html" />
<meta property="og:url" content="https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:image" content="https://cedric-perauer.github.io/DL_from_Foundations/images/logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-21T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-04-21T00:00:00-05:00","dateModified":"2020-04-21T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html"},"description":"Imagenette and Training our classifier (Lesson 5 Part 4)","image":"https://cedric-perauer.github.io/DL_from_Foundations/images/logo.png","@type":"BlogPosting","url":"https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html","headline":"Fastai Course DL from the Foundations Train on Imagenette","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DL_from_Foundations/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cedric-perauer.github.io/DL_from_Foundations/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/DL_from_Foundations/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Fastai Course DL from the Foundations Train on Imagenette | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Fastai Course DL from the Foundations Train on Imagenette" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Imagenette and Training our classifier (Lesson 5 Part 4)" />
<meta property="og:description" content="Imagenette and Training our classifier (Lesson 5 Part 4)" />
<link rel="canonical" href="https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html" />
<meta property="og:url" content="https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:image" content="https://cedric-perauer.github.io/DL_from_Foundations/images/logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-21T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2020-04-21T00:00:00-05:00","dateModified":"2020-04-21T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html"},"description":"Imagenette and Training our classifier (Lesson 5 Part 4)","image":"https://cedric-perauer.github.io/DL_from_Foundations/images/logo.png","@type":"BlogPosting","url":"https://cedric-perauer.github.io/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html","headline":"Fastai Course DL from the Foundations Train on Imagenette","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://cedric-perauer.github.io/DL_from_Foundations/feed.xml" title="fastpages" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DL_from_Foundations/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DL_from_Foundations/about/">About Me</a><a class="page-link" href="/DL_from_Foundations/search/">Search</a><a class="page-link" href="/DL_from_Foundations/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fastai Course DL from the Foundations Train on Imagenette</h1><p class="page-description">Imagenette and Training our classifier (Lesson 5 Part 4)</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-21T00:00:00-05:00" itemprop="datePublished">
        Apr 21, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/DL_from_Foundations/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Cedric-Perauer/DL_from_Foundations/tree/master/_notebooks/2020-04-21-4trainimagenette.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/DL_from_Foundations/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Cedric-Perauer/DL_from_Foundations/master?filepath=_notebooks%2F2020-04-21-4trainimagenette.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DL_from_Foundations/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Cedric-Perauer/DL_from_Foundations/blob/master/_notebooks/2020-04-21-4trainimagenette.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DL_from_Foundations/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Fastai-Imagenet(te)-training">Fastai Imagenet(te) training </a></li>
<li class="toc-entry toc-h2"><a href="#XResNet">XResNet </a>
<ul>
<li class="toc-entry toc-h3"><a href="#ResBlock-Details">ResBlock Details </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Train">Train </a></li>
<li class="toc-entry toc-h2"><a href="#cnn_learner">cnn_learner </a></li>
<li class="toc-entry toc-h2"><a href="#Imagenet">Imagenet </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-21-4trainimagenette.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fastai-Imagenet(te)-training">
<a class="anchor" href="#Fastai-Imagenet(te)-training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fastai Imagenet(te) training<a class="anchor-link" href="#Fastai-Imagenet(te)-training"> </a>
</h2>
<p>FP16 should allow 2x speed ups in theory, practicaly it also depends on the number of fp16 vs fp32 cores on your GPU.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>

<span class="kn">from</span> <span class="nn">exp.nb_10c</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://course.fast.ai/videos/?lesson=12&amp;t=1681">Jump_to lesson 12 video</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"/media/cedric/Datasets/imagenette2-160/"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>

<span class="n">size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_rgb</span><span class="p">,</span> <span class="n">RandomResizedCrop</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.35</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">np_to_float</span><span class="p">,</span> <span class="n">PilRandomFlip</span><span class="p">()]</span>

<span class="n">bs</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">il</span> <span class="o">=</span> <span class="n">ImageList</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">SplitData</span><span class="o">.</span><span class="n">split_by_func</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="n">grandparent_splitter</span><span class="p">,</span> <span class="n">valid_name</span><span class="o">=</span><span class="s1">'val'</span><span class="p">))</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">label_by_func</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="n">parent_labeler</span><span class="p">,</span> <span class="n">proc_y</span><span class="o">=</span><span class="n">CategoryProcessor</span><span class="p">())</span>

<span class="n">ll</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_rgb</span><span class="p">,</span> <span class="n">CenterCrop</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">np_to_float</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">ll</span><span class="o">.</span><span class="n">to_databunch</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="XResNet">
<a class="anchor" href="#XResNet" aria-hidden="true"><span class="octicon octicon-link"></span></a>XResNet<a class="anchor-link" href="#XResNet"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://course.fast.ai/videos/?lesson=12&amp;t=1701">Jump_to lesson 12 video</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">noop</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span>

<span class="k">class</span> <span class="nc">Flatten</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">ks</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">ks</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">act_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">init_cnn</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">'bias'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">,</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">)):</span> <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_normal_</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">children</span><span class="p">():</span> <span class="n">init_cnn</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">conv_layer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">zero_bn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="n">bn</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="mf">0.</span> <span class="k">if</span> <span class="n">zero_bn</span> <span class="k">else</span> <span class="mf">1.</span><span class="p">)</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">conv</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">ks</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">),</span> <span class="n">bn</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">act</span><span class="p">:</span> <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">act_fn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">class</span> <span class="nc">ResBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expansion</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">nf</span><span class="p">,</span><span class="n">ni</span> <span class="o">=</span> <span class="n">nh</span><span class="o">*</span><span class="n">expansion</span><span class="p">,</span><span class="n">ni</span><span class="o">*</span><span class="n">expansion</span>
        <span class="n">layers</span>  <span class="o">=</span> <span class="p">[</span><span class="n">conv_layer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">),</span>
                   <span class="n">conv_layer</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">zero_bn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">]</span> <span class="k">if</span> <span class="n">expansion</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">[</span>
                   <span class="n">conv_layer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                   <span class="n">conv_layer</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">),</span>
                   <span class="n">conv_layer</span><span class="p">(</span><span class="n">nh</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">zero_bn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convs</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idconv</span> <span class="o">=</span> <span class="n">noop</span> <span class="k">if</span> <span class="n">ni</span><span class="o">==</span><span class="n">nf</span> <span class="k">else</span> <span class="n">conv_layer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">noop</span> <span class="k">if</span> <span class="n">stride</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="n">nn</span><span class="o">.</span><span class="n">AvgPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ceil_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">act_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">idconv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ResBlock-Details">
<a class="anchor" href="#ResBlock-Details" aria-hidden="true"><span class="octicon octicon-link"></span></a>ResBlock Details<a class="anchor-link" href="#ResBlock-Details"> </a>
</h3>
<p>Batch Norm sometimes has weights of 0 and sometimes 1 during init. It allows us to init the Conv branch to 0 and the identity mapping to 1. The gradient won't explode that way. 
ResNet 50 and onwards use 3 convs, smaller ones use 2. They also use Bottleneck layers (64 filters-&gt; 16filters -&gt; 64 filters), the normal block for larger ResNets. ResNet-D also uses downsample to make sure the two branches can be added. So when stride is not 1, and AvgPool layer with stride of 2 is deployed for different grid size, and 1x1 conv to change the number of filters (if not equal). 
<img src="/DL_from_Foundations/images/copied_from_nb/images/resnetd.png" alt="images"></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">class</span> <span class="nc">XResNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expansion</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">nfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">c_in</span><span class="p">,</span> <span class="p">(</span><span class="n">c_in</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>
        <span class="n">stem</span> <span class="o">=</span> <span class="p">[</span><span class="n">conv_layer</span><span class="p">(</span><span class="n">nfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nfs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

        <span class="n">nfs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="o">//</span><span class="n">expansion</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">512</span><span class="p">]</span>
        <span class="n">res_layers</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">_make_layer</span><span class="p">(</span><span class="n">expansion</span><span class="p">,</span> <span class="n">nfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nfs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
                                      <span class="n">n_blocks</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">layers</span><span class="p">)]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="o">*</span><span class="n">stem</span><span class="p">,</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="o">*</span><span class="n">res_layers</span><span class="p">,</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Flatten</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">nfs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">expansion</span><span class="p">,</span> <span class="n">c_out</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">init_cnn</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_make_layer</span><span class="p">(</span><span class="n">expansion</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">n_blocks</span><span class="p">,</span> <span class="n">stride</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span><span class="n">ResBlock</span><span class="p">(</span><span class="n">expansion</span><span class="p">,</span> <span class="n">ni</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">nf</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">stride</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_blocks</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">xresnet18</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">return</span> <span class="n">XResNet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">xresnet34</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">return</span> <span class="n">XResNet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">xresnet50</span> <span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">return</span> <span class="n">XResNet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">xresnet101</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">return</span> <span class="n">XResNet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">xresnet152</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="k">return</span> <span class="n">XResNet</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train">
<a class="anchor" href="#Train" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train<a class="anchor-link" href="#Train"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://course.fast.ai/videos/?lesson=12&amp;t=2515">Jump_to lesson 12 video</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">cbfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">AvgStatsCallback</span><span class="p">,</span><span class="n">accuracy</span><span class="p">),</span> <span class="n">ProgressCallback</span><span class="p">,</span> <span class="n">CudaCallback</span><span class="p">,</span>
        <span class="n">partial</span><span class="p">(</span><span class="n">BatchTransformXCallback</span><span class="p">,</span> <span class="n">norm_imagenette</span><span class="p">),</span>
<span class="c1">#         partial(MixUp, alpha=0.2)</span>
       <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">LabelSmoothingCrossEntropy</span><span class="p">()</span>
<span class="n">arch</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">xresnet18</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">opt_func</span> <span class="o">=</span> <span class="n">adam_opt</span><span class="p">(</span><span class="n">mom</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">mom_sqr</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">get_batch</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span> <span class="n">learn</span><span class="p">):</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">xb</span><span class="p">,</span><span class="n">learn</span><span class="o">.</span><span class="n">yb</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dl</span><span class="p">))</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">do_begin_fit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">learn</span><span class="p">(</span><span class="s1">'begin_batch'</span><span class="p">)</span>
    <span class="n">learn</span><span class="p">(</span><span class="s1">'after_fit'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">learn</span><span class="o">.</span><span class="n">xb</span><span class="p">,</span><span class="n">learn</span><span class="o">.</span><span class="n">yb</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to replace the old <code>model_summary</code> since it used to take a <code>Runner</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">model_summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">find_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_mod</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="o">=</span> <span class="n">get_batch</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">valid_dl</span><span class="p">,</span> <span class="n">learn</span><span class="p">)</span>
    <span class="n">mods</span> <span class="o">=</span> <span class="n">find_modules</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">is_lin_layer</span><span class="p">)</span> <span class="k">if</span> <span class="n">find_all</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">hook</span><span class="p">,</span><span class="n">mod</span><span class="p">,</span><span class="n">inp</span><span class="p">,</span><span class="n">out</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"====</span><span class="se">\n</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span> <span class="k">if</span> <span class="n">print_mod</span> <span class="k">else</span> <span class="s2">""</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">Hooks</span><span class="p">(</span><span class="n">mods</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">hooks</span><span class="p">:</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">arch</span><span class="p">(),</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cb_funcs</span><span class="o">=</span><span class="n">cbfs</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">learn</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">model_summary</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">print_mod</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_accuracy</th>
      <th>valid_loss</th>
      <th>valid_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> torch.Size([128, 32, 64, 64])
 torch.Size([128, 64, 64, 64])
 torch.Size([128, 64, 64, 64])
 torch.Size([128, 64, 32, 32])
 torch.Size([128, 64, 32, 32])
 torch.Size([128, 128, 16, 16])
 torch.Size([128, 256, 8, 8])
 torch.Size([128, 512, 4, 4])
 torch.Size([128, 512, 1, 1])
 torch.Size([128, 512])
 torch.Size([128, 10])
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">arch</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">xresnet34</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">arch</span><span class="p">(),</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cb_funcs</span><span class="o">=</span><span class="n">cbfs</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">LR_Find</span><span class="p">(),</span> <span class="n">Recorder</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='0' class='' max='1', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_accuracy</th>
      <th>valid_loss</th>
      <th>valid_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">create_phases</span><span class="p">(</span><span class="n">phases</span><span class="p">):</span>
    <span class="n">phases</span> <span class="o">=</span> <span class="n">listify</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phases</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">phases</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="nb">print</span><span class="p">(</span><span class="n">create_phases</span><span class="p">(</span><span class="mf">0.3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">create_phases</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.3, 0.7]
[0.3, 0.2, 0.5]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">pct_start</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">phases</span> <span class="o">=</span> <span class="n">create_phases</span><span class="p">(</span><span class="n">pct_start</span><span class="p">)</span>
<span class="n">sched_lr</span>  <span class="o">=</span> <span class="n">combine_scheds</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span> <span class="n">cos_1cycle_anneal</span><span class="p">(</span><span class="n">lr</span><span class="o">/</span><span class="mf">10.</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">lr</span><span class="o">/</span><span class="mf">1e5</span><span class="p">))</span>
<span class="n">sched_mom</span> <span class="o">=</span> <span class="n">combine_scheds</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span> <span class="n">cos_1cycle_anneal</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">cbsched</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ParamScheduler</span><span class="p">(</span><span class="s1">'lr'</span><span class="p">,</span> <span class="n">sched_lr</span><span class="p">),</span>
    <span class="n">ParamScheduler</span><span class="p">(</span><span class="s1">'mom'</span><span class="p">,</span> <span class="n">sched_mom</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">arch</span><span class="p">(),</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">cb_funcs</span><span class="o">=</span><span class="n">cbfs</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">cbsched</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='0' class='' max='5', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_accuracy</th>
      <th>valid_loss</th>
      <th>valid_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.712231</td>
      <td>0.481888</td>
      <td>2.218922</td>
      <td>0.413758</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.533136</td>
      <td>0.565002</td>
      <td>1.515309</td>
      <td>0.582930</td>
      <td>00:19</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.375577</td>
      <td>0.637343</td>
      <td>1.560793</td>
      <td>0.553631</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.195946</td>
      <td>0.718344</td>
      <td>1.094210</td>
      <td>0.756433</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.043024</td>
      <td>0.780019</td>
      <td>0.994323</td>
      <td>0.798726</td>
      <td>00:18</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="cnn_learner">
<a class="anchor" href="#cnn_learner" aria-hidden="true"><span class="octicon octicon-link"></span></a>cnn_learner<a class="anchor-link" href="#cnn_learner"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://course.fast.ai/videos/?lesson=12&amp;t=2711">Jump_to lesson 12 video</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>

<span class="k">def</span> <span class="nf">cnn_learner</span><span class="p">(</span><span class="n">arch</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="p">,</span> <span class="n">c_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c_out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mixup</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xtra_cb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cbfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">AvgStatsCallback</span><span class="p">,</span><span class="n">accuracy</span><span class="p">)]</span><span class="o">+</span><span class="n">listify</span><span class="p">(</span><span class="n">xtra_cb</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">progress</span><span class="p">:</span> <span class="n">cbfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ProgressCallback</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cuda</span><span class="p">:</span>     <span class="n">cbfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CudaCallback</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>     <span class="n">cbfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">BatchTransformXCallback</span><span class="p">,</span> <span class="n">norm</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">mixup</span><span class="p">:</span>    <span class="n">cbfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">MixUp</span><span class="p">,</span> <span class="n">mixup</span><span class="p">))</span>
    <span class="n">arch_args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">c_in</span> <span class="p">:</span> <span class="n">c_in</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">c_in</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">c_out</span><span class="p">:</span> <span class="n">c_out</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">c_out</span>
    <span class="k">if</span> <span class="n">c_in</span><span class="p">:</span>  <span class="n">arch_args</span><span class="p">[</span><span class="s1">'c_in'</span> <span class="p">]</span><span class="o">=</span><span class="n">c_in</span>
    <span class="k">if</span> <span class="n">c_out</span><span class="p">:</span> <span class="n">arch_args</span><span class="p">[</span><span class="s1">'c_out'</span><span class="p">]</span><span class="o">=</span><span class="n">c_out</span>
    <span class="k">return</span> <span class="n">Learner</span><span class="p">(</span><span class="n">arch</span><span class="p">(</span><span class="o">**</span><span class="n">arch_args</span><span class="p">),</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">cb_funcs</span><span class="o">=</span><span class="n">cbfs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">xresnet34</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_imagenette</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>

<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">cbsched</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='0' class='' max='5', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      
    </div>
    

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_accuracy</th>
      <th>valid_loss</th>
      <th>valid_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.734203</td>
      <td>0.474813</td>
      <td>1.960827</td>
      <td>0.469299</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.525025</td>
      <td>0.574506</td>
      <td>2.046430</td>
      <td>0.447643</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.396191</td>
      <td>0.626888</td>
      <td>1.789930</td>
      <td>0.493248</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.216749</td>
      <td>0.706833</td>
      <td>1.156404</td>
      <td>0.729427</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.043234</td>
      <td>0.776956</td>
      <td>1.005148</td>
      <td>0.792102</td>
      <td>00:18</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imagenet">
<a class="anchor" href="#Imagenet" aria-hidden="true"><span class="octicon octicon-link"></span></a>Imagenet<a class="anchor-link" href="#Imagenet"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can see all this put together in the fastai <a href="https://github.com/fastai/fastai/blob/master/examples/train_imagenet.py">imagenet training script</a>. It's the same as what we've seen so far, except it also handles multi-GPU training. So how well does this work?</p>
<p>We trained for 60 epochs, and got an error of 5.9%, compared to the official PyTorch resnet which gets 7.5% error in 90 epochs! Our xresnet 50 training even surpasses standard resnet 152, which trains for 50% more epochs and has 3x as many layers.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Cedric-Perauer/DL_from_Foundations"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/DL_from_Foundations/jupyter/2020/04/21/4trainimagenette.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DL_from_Foundations/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DL_from_Foundations/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/DL_from_Foundations/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
